<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Thanh Chọn Màu Đầy Đủ</title>
  <style>
    body { font-family: sans-serif; display: flex; flex-direction: column; align-items: center; margin-top: 40px;}
    #color-bar-wrapper { position: relative; width: 600px; height: 72px; margin-top: 30px;}
    #color-bar { width: 100%; height: 72px; border-radius: 18px; cursor: pointer; box-shadow: 0 0 12px #aaa;}
    #marker { position: absolute; width: 18px; height: 72px; border: 2px solid #fff; border-radius: 8px; pointer-events: none; box-shadow: 0 0 8px #0008; top: 0;}
    #color-info {
      margin-top: 22px; font-size: 1.2em;
      display: flex; flex-direction: column; align-items: flex-start;
      min-width: 340px;
      background: #f8f8f8;
      padding: 16px 24px;
      border-radius: 16px;
      box-shadow: 0 0 16px #eee;
      position: relative;
    }
    #copy-btn { margin-left: 0; margin-top: 8px; padding: 6px 16px; font-size: 1em; cursor: pointer; }
    #color-name {
      margin-left: 0;
      margin-top: 8px;
      font-weight: bold;
      font-size: 1.15em;
      min-width: 150px;
    }
    #sample-color {
      width: 200px;
      height: 80px;
      border-radius: 14px;
      border: 2px solid #888;
      margin-left: 0;
      margin-top: 12px;
      box-shadow: 0 0 18px #aaa;
      background: #fff;
      display: inline-block;
      vertical-align: middle;
    }
    #rgb-value {
      margin-left: 0;
      margin-top: 8px;
      font-size: 1.08em;
      color: #444;
      min-width: 120px;
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      line-height: 1.6;
    }
    .rgb-label {
      font-weight: bold;
      margin-right: 4px;
    }
    .rgb-r { color: #d00; }
    .rgb-g { color: #090; }
    .rgb-b { color: #06c; }
    .rgb-percent {
      color: #666;
      font-size: 0.98em;
      margin-left: 2px;
      font-weight: normal;
    }
    .desc-note {
      margin-top: 18px;
      color: #555;
      font-size: 1em;
      background: #eef2f7;
      border-radius: 8px;
      padding: 12px 16px;
      line-height: 1.7;
      max-width: 420px;
    }
    .footer-link {
      margin-top: 60px;
      font-size: 1.15em;
    }
    .created-by {
      margin-top: 10px;
      margin-bottom: 18px;
      color: #666;
      font-size: 1em;
    }
  </style>
</head>
<body>
  <h2>Thanh Chọn Màu Đầy Đủ</h2>
  <div>Kéo thanh để chọn màu, đầy đủ sắc thái</div>
  <div id="color-bar-wrapper">
    <canvas id="color-bar" width="600" height="72"></canvas>
    <div id="marker" style="display:none"></div>
  </div>
  <div id="color-info">
    <div>Mã màu: <span id="color-code">#FF0000</span></div>
    <button id="copy-btn">Copy</button>
    <div id="color-name">Màu đỏ</div>
    <div id="rgb-value">
      <div><span class="rgb-label rgb-r">R:</span>255 <span class="rgb-percent">(100%)</span></div>
      <div><span class="rgb-label rgb-g">G:</span>0 <span class="rgb-percent">(0%)</span></div>
      <div><span class="rgb-label rgb-b">B:</span>0 <span class="rgb-percent">(0%)</span></div>
    </div>
    <div id="sample-color" style="background:#FF0000"></div>
    <div class="desc-note">
      <b>Chú thích:</b><br>
      - Thông số <b>R, G, B</b> là giá trị màu Đỏ, Xanh Lá, Xanh Dương theo hệ màu RGB, nằm trong khoảng từ <b>0</b> đến <b>255</b>.<br>
      - Phần trăm (%) bên cạnh là tỉ lệ mỗi kênh màu so với giá trị tối đa (255), giúp bạn ước lượng khi pha chế hoặc phối màu.<br>
      - Ví dụ: <b>R:128 (50%)</b> nghĩa là thành phần màu đỏ chiếm 50% cường độ tối đa.<br>
      - Tỉ lệ này rất hữu ích khi bạn cần pha màu theo công thức hoặc phối hợp màu sắc chuẩn xác.
    </div>
  </div>
  <div class="footer-link">
    <a href="https://nhut990.github.io/">Quay về trang chủ</a>
  </div>
  <div class="created-by">
    Created by Minh Nhựt
  </div>
  <script>
    const canvas = document.getElementById('color-bar');
    const ctx = canvas.getContext('2d');
    const marker = document.getElementById('marker');
    const colorCodeSpan = document.getElementById('color-code');
    const copyBtn = document.getElementById('copy-btn');
    const sampleColorDiv = document.getElementById('sample-color');
    const colorNameDiv = document.getElementById('color-name');
    const rgbValueDiv = document.getElementById('rgb-value');
    const width = canvas.width;
    const height = canvas.height;

    function drawColorBar() {
      const grad = ctx.createLinearGradient(0, 0, width, 0);
      for(let i=0; i<=360; i+=10) {
        grad.addColorStop(i/360, `hsl(${i},100%,50%)`);
      }
      ctx.fillStyle = grad;
      ctx.fillRect(0,0,width,height);
    }
    drawColorBar();

    function getColorAtPosition(x) {
      const h = Math.max(0, Math.min(360, Math.round(x/width*360)));
      const s = 1.0, l = 0.5;
      const hex = hslToHex(h, s, l);
      const rgb = hexToRgb(hex);
      return {hex, h, s, l, rgb};
    }

    function hslToHex(h, s, l) {
      s = Math.min(1, Math.max(0, s));
      l = Math.min(1, Math.max(0, l));
      h = h/360;
      let r, g, b;
      if (s === 0) r = g = b = l;
      else {
        function hue2rgb(p, q, t) {
          if (t < 0) t += 1;
          if (t > 1) t -= 1;
          if (t < 1/6) return p + (q-p)*6*t;
          if (t < 1/2) return q;
          if (t < 2/3) return p + (q-p)*(2/3-t)*6;
          return p;
        }
        const q = l < 0.5 ? l*(1+s) : l+s-l*s;
        const p = 2*l - q;
        r = hue2rgb(p, q, h+1/3);
        g = hue2rgb(p, q, h);
        b = hue2rgb(p, q, h-1/3);
      }
      return "#" + [r,g,b].map(x => Math.round(x*255).toString(16).padStart(2,"0")).join("");
    }

    function hexToRgb(hex) {
      hex = hex.replace('#','');
      let r = parseInt(hex.substring(0,2), 16);
      let g = parseInt(hex.substring(2,4), 16);
      let b = parseInt(hex.substring(4,6), 16);
      return {r, g, b};
    }

    // Nhận diện tên màu tiếng Việt hợp lý nhất theo Hue HSL
    function getVietnameseColorName(h, s, l) {
      // Các màu đơn sắc
      if (l >= 0.95) return "Màu trắng";
      if (l <= 0.10) return "Màu đen";
      if (s <= 0.12 && l > 0.10 && l < 0.88) return "Màu xám";
      if (l >= 0.88 && h >= 40 && h <= 70) return "Màu kem";
      // Nâu (brown/be, nâu đỏ đậm)
      if ((h >= 20 && h < 45) && l < 0.54 && s > 0.25) return "Màu nâu";
      if ((h >= 45 && h < 55) && l < 0.54 && s > 0.23) return "Màu vàng nâu";
      if ((h >= 18 && h < 45) && l >= 0.54 && l < 0.80 && s < 0.32) return "Màu be";
      // Đỏ
      if ((h >= 0 && h < 13) || (h >= 347 && h <= 360)) return "Màu đỏ";
      // Cam
      if (h >= 13 && h < 30) return "Màu cam đỏ";
      if (h >= 30 && h < 45) return "Màu cam";
      // Vàng các loại
      if (h >= 45 && h < 54) return "Vàng cam";
      if (h >= 54 && h <= 66) return "Màu vàng"; // #ffff00 là hue=60
      if (h > 66 && h <= 80) return "Vàng chanh";
      // Xanh lá các sắc độ
      if (h > 80 && h <= 140) return "Xanh lá cây";
      if (h > 140 && h <= 166) return "Xanh lục";
      // Xanh ngọc, cyan
      if (h > 166 && h <= 185) return "Xanh ngọc";
      if (h > 185 && h <= 195) return "Xanh cyan";
      // Xanh nước biển, da trời
      if (h > 195 && h <= 210) return "Xanh nước biển";
      if (h > 210 && h <= 225) return "Xanh da trời";
      // Xanh lam
      if (h > 225 && h <= 245) return "Xanh lam";
      // Navy
      if (h > 245 && h <= 260) return "Xanh navy";
      // Tím các loại
      if (h > 260 && h <= 280) return "Màu tím";
      if (h > 280 && h <= 295) return "Tím hồng";
      // Hồng, đỏ hồng
      if (h > 295 && h <= 320) return "Màu hồng";
      if (h > 320 && h < 347) return "Đỏ hồng";
      return "Màu không xác định";
    }

    function percent(val) {
      return Math.round(val / 255 * 100);
    }

    function showColorAt(x) {
      const colorData = getColorAtPosition(x);
      colorCodeSpan.textContent = colorData.hex;
      marker.style.display = "block";
      marker.style.left = (x-9) + "px";
      marker.style.background = colorData.hex;
      sampleColorDiv.style.background = colorData.hex;
      colorNameDiv.textContent = getVietnameseColorName(colorData.h, colorData.s, colorData.l);
      rgbValueDiv.innerHTML =
        `<div><span class="rgb-label rgb-r">R:</span>${colorData.rgb.r} <span class="rgb-percent">(${percent(colorData.rgb.r)}%)</span></div>
         <div><span class="rgb-label rgb-g">G:</span>${colorData.rgb.g} <span class="rgb-percent">(${percent(colorData.rgb.g)}%)</span></div>
         <div><span class="rgb-label rgb-b">B:</span>${colorData.rgb.b} <span class="rgb-percent">(${percent(colorData.rgb.b)}%)</span></div>`;
    }

    function handleSelection(e) {
      let rect = canvas.getBoundingClientRect();
      let x;
      if (e.touches) {
        x = e.touches[0].clientX - rect.left;
      } else {
        x = e.offsetX;
      }
      x = Math.max(0, Math.min(width-1, x));
      showColorAt(x);
    }

    canvas.addEventListener('mousedown', function(e){
      handleSelection(e);
      canvas.addEventListener('mousemove', handleSelection);
    });
    canvas.addEventListener('mouseup', function(){canvas.removeEventListener('mousemove', handleSelection);});
    canvas.addEventListener('mouseleave', function(){canvas.removeEventListener('mousemove', handleSelection);});
    canvas.addEventListener('touchstart', function(e){handleSelection(e);});
    canvas.addEventListener('touchmove', function(e){handleSelection(e); e.preventDefault();});

    // Hiển thị màu mặc định ban đầu
    showColorAt(0);

    copyBtn.onclick = function() {
      const color = colorCodeSpan.textContent;
      navigator.clipboard.writeText(color);
      copyBtn.textContent = `Đã copy ${color}`;
      setTimeout(()=>copyBtn.textContent="Copy", 1200);
    };
  </script>
</body>
</html>